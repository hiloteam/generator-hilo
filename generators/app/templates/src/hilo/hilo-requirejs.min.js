/**
 * Hilo 1.0.0 for requirejs
 * Copyright 2015 alibaba.com
 * Licensed under the MIT License
 */
define("hilo/core/Hilo",function(){var t=function(){var e=window,i=document,n=i.documentElement,r=0;return{getUid:function(t){var e=++r;if(t){var i=t.charCodeAt(t.length-1);return i>=48&&57>=i&&(t+="_"),t+e}return e},viewToString:function(t){for(var e,i=t;i;)e=e?i.id+"."+e:i.id,i=i.parent;return e},copy:function(t,e,i){for(var n in e)(!i||t.hasOwnProperty(n)||void 0!==t[n])&&(t[n]=e[n]);return t},browser:function(){var t=navigator.userAgent,r={iphone:/iphone/i.test(t),ipad:/ipad/i.test(t),ipod:/ipod/i.test(t),ios:/iphone|ipad|ipod/i.test(t),android:/android/i.test(t),webkit:/webkit/i.test(t),chrome:/chrome/i.test(t),safari:/safari/i.test(t),firefox:/firefox/i.test(t),ie:/msie/i.test(t),opera:/opera/i.test(t),supportTouch:"ontouchstart"in e,supportCanvas:null!=i.createElement("canvas").getContext,supportStorage:!1,supportOrientation:"orientation"in e,supportDeviceMotion:"ondevicemotion"in e};try{var a="hilo";localStorage.setItem(a,a),localStorage.removeItem(a),r.supportStorage=!0}catch(o){}var s=r.jsVendor=r.webkit?"webkit":r.firefox?"Moz":r.opera?"O":r.ie?"ms":"",h=r.cssVendor="-"+s+"-",l=i.createElement("div"),c=l.style,u=void 0!=c[s+"Transform"],d=void 0!=c[s+"Perspective"];return d&&(l.id="test3d",c=i.createElement("style"),c.textContent="@media ("+h+"transform-3d){#test3d{height:3px}}",i.head.appendChild(c),n.appendChild(l),d=3==l.offsetHeight,i.head.removeChild(c),n.removeChild(l)),r.supportTransform=u,r.supportTransform3D=d,r}(),event:function(){var t="ontouchstart"in e;return{POINTER_START:t?"touchstart":"mousedown",POINTER_MOVE:t?"touchmove":"mousemove",POINTER_END:t?"touchend":"mouseup"}}(),align:{TOP_LEFT:"TL",TOP:"T",TOP_RIGHT:"TR",LEFT:"L",CENTER:"C",RIGHT:"R",BOTTOM_LEFT:"BL",BOTTOM:"B",BOTTOM_RIGHT:"BR"},getElementRect:function(t){try{var i=t.getBoundingClientRect()}catch(r){i={top:t.offsetTop,left:t.offsetLeft,width:t.offsetWidth,height:t.offsetHeight}}var a=(e.pageXOffset||n.scrollLeft)-(n.clientLeft||0)||0,o=(e.pageYOffset||n.scrollTop)-(n.clientTop||0)||0,s=e.getComputedStyle?getComputedStyle(t):t.currentStyle,h=parseInt,l=h(s.paddingLeft)+h(s.borderLeftWidth)||0,c=h(s.paddingTop)+h(s.borderTopWidth)||0,u=h(s.paddingRight)+h(s.borderRightWidth)||0,d=h(s.paddingBottom)+h(s.borderBottomWidth)||0,f=i.top||0,v=i.left||0;return{left:v+a+l,top:f+o+c,width:i.right-u-v-l,height:i.bottom-d-f-c}},createElement:function(t,e){var n,r,a,o=i.createElement(t);for(n in e)if(r=e[n],"style"===n)for(a in r)o.style[a]=r[a];else o[n]=r;return o},getElement:function(t){return i.getElementById(t)},setElementStyleByView:function(e){var i=e.drawable,n=i.domElement.style,r=e._stateCache||(e._stateCache={}),a=t.browser.jsVendor,o="px",s=!1;if(this.cacheStateIfChanged(e,["visible"],r)&&(n.display=e.visible?"":"none"),this.cacheStateIfChanged(e,["alpha"],r)&&(n.opacity=e.alpha),e.visible&&!(e.alpha<=0)){this.cacheStateIfChanged(e,["width"],r)&&(n.width=e.width+o),this.cacheStateIfChanged(e,["height"],r)&&(n.height=e.height+o),this.cacheStateIfChanged(e,["depth"],r)&&(n.zIndex=e.depth+1),(s=this.cacheStateIfChanged(e,["pivotX","pivotY"],r))&&(n[a+"TransformOrigin"]=e.pivotX+o+" "+e.pivotY+o),(this.cacheStateIfChanged(e,["x","y","rotation","scaleX","scaleY"],r)||s)&&(n[a+"Transform"]=this.getTransformCSS(e)),this.cacheStateIfChanged(e,["background"],r)&&(n.backgroundColor=e.background),n.pointerEvents||(n.pointerEvents="none");var h=i.image;if(h){var l=h.src;l!==r.image&&(r.image=l,n.backgroundImage="url("+l+")");var c=i.rect;if(c){var u=c[0],d=c[1];u!==r.sx&&(r.sx=u,n.backgroundPositionX=-u+o),d!==r.sy&&(r.sy=d,n.backgroundPositionY=-d+o)}}var f=e.mask;if(f){var v=f.drawable.domElement.style.backgroundImage;v!==r.maskImage&&(r.maskImage=v,n[a+"MaskImage"]=v,n[a+"MaskRepeat"]="no-repeat");var p=f.x,m=f.y;(p!==r.maskX||m!==r.maskY)&&(r.maskX=p,r.maskY=m,n[a+"MaskPosition"]=p+o+" "+m+o)}}},cacheStateIfChanged:function(t,e,i){var n,r,a,o,s=!1;for(n=0,r=e.length;r>n;n++)a=e[n],o=t[a],o!=i[a]&&(i[a]=o,s=!0);return s},getTransformCSS:function(t){var e=this.browser.supportTransform3D,i=e?"3d":"";return"translate"+i+"("+(t.x-t.pivotX)+"px, "+(t.y-t.pivotY)+(e?"px, 0px)":"px)")+"rotate"+i+(e?"(0, 0, 1, ":"(")+t.rotation+"deg)scale"+i+"("+t.scaleX+", "+t.scaleY+(e?", 1)":")")}}}();return t}),define("hilo/core/Class",function(){var t=function(){var t=function(t){t=t||{};var i=t.hasOwnProperty("constructor")?t.constructor:function(){};return e.call(i,t),i},e=function(t){var e,n,a={};for(e in t)n=t[e],i.hasOwnProperty(e)?i[e].call(this,n):a[e]=n;r(this.prototype,a)},i={Extends:function(t){var e=this.prototype,i=n(t.prototype);r(this,t),r(i,e),i.constructor=this,this.prototype=i,this.superclass=t.prototype},Mixes:function(t){t instanceof Array||(t=[t]);for(var e,i=this.prototype;e=t.shift();)r(i,e.prototype||e)},Statics:function(t){r(this,t)}},n=function(){if(Object.__proto__)return function(t){return{__proto__:t}};var t=function(){};return function(e){return t.prototype=e,new t}}(),r=function(t){for(var e=1,i=arguments.length;i>e;e++){var n,r=arguments[e];for(var a in r){var s=r[a];!s||"object"!=typeof s||void 0===s.value&&"function"!=typeof s.get&&"function"!=typeof s.set?t[a]=s:(n=n||{},n[a]=s)}n&&o(t,n)}return t};try{var a=Object.defineProperty,o=Object.defineProperties;a({},"$",{value:0})}catch(s){"__defineGetter__"in Object&&(a=function(t,e,i){return"value"in i&&(t[e]=i.value),"get"in i&&t.__defineGetter__(e,i.get),"set"in i&&t.__defineSetter__(e,i.set),t},o=function(t,e){for(var i in e)e.hasOwnProperty(i)&&a(t,i,e[i]);return t})}return{create:t,mix:r}}();return t}),define("hilo/event/EventMixin",["hilo/core/Class"],function(t){var e={_listeners:null,on:function(t,e,i){for(var n=this._listeners=this._listeners||{},r=n[t]=n[t]||[],a=0,o=r.length;o>a;a++){var s=r[a];if(s.listener===e)return}return r.push({listener:e,once:i}),this},off:function(t,e){if(0==arguments.length)return this._listeners=null,this;var i=this._listeners&&this._listeners[t];if(i){if(1==arguments.length)return delete this._listeners[t],this;for(var n=0,r=i.length;r>n;n++){var a=i[n];if(a.listener===e){i.splice(n,1),0===i.length&&delete this._listeners[t];break}}}return this},fire:function(t,e){var n,r;"string"==typeof t?r=t:(n=t,r=t.type);var a=this._listeners;if(!a)return!1;var o=a[r];if(o){if(o=o.slice(0),n=n||new i(r,this,e),n._stopped)return!1;for(var s=0;s<o.length;s++){var h=o[s];h.listener.call(this,n),h.once&&o.splice(s--,1)}return 0==o.length&&delete a[r],!0}return!1}},i=t.create({constructor:function(t,e,i){this.type=t,this.target=e,this.detail=i,this.timeStamp=+new Date},type:null,target:null,detail:null,timeStamp:0,stopImmediatePropagation:function(){this._stopped=!0}}),n=window.Event;if(n){var r=n.prototype,a=r.stopImmediatePropagation;r.stopImmediatePropagation=function(){a&&a.call(this),this._stopped=!0}}return e}),define("hilo/view/Drawable",["hilo/core/Hilo","hilo/core/Class"],function(t,e){var i=e.create({constructor:function(t){this.init(t)},image:null,rect:null,init:function(e){var n=this,r=n.image;i.isDrawable(e)?n.image=e:t.copy(n,e,!0);var a=n.image;if("string"==typeof a){if(!r||a!==r.getAttribute("src")){n.image=null;var o=new Image;return o.onload=function(){o.onload=null,n.init(o)},void(o.src=a)}a=n.image=r}a&&!n.rect&&(n.rect=[0,0,a.width,a.height])},Statics:{isDrawable:function(t){if(!t||!t.tagName)return!1;var e=t.tagName.toLowerCase();return"img"===e||"canvas"===e||"video"===e}}});return i}),define("hilo/renderer/Renderer",["hilo/core/Hilo","hilo/core/Class"],function(t,e){var i=e.create({constructor:function(e){e=e||{},t.copy(this,e,!0)},canvas:null,stage:null,startDraw:function(t){},draw:function(t){},endDraw:function(t){},transform:function(){},hide:function(){},remove:function(t){},clear:function(t,e,i,n){},resize:function(t,e){}});return i}),define("hilo/renderer/CanvasRenderer",["hilo/core/Class","hilo/core/Hilo","hilo/renderer/Renderer"],function(t,e,i){var n=t.create({Extends:i,constructor:function(t){n.superclass.constructor.call(this,t),this.context=this.canvas.getContext("2d")},context:null,startDraw:function(t){return t.visible&&t.alpha>0?(t===this.stage&&this.context.clearRect(0,0,t.width,t.height),this.context.save(),!0):!1},draw:function(t){var e=this.context,i=t.width,n=t.height,r=t.background;r&&(e.fillStyle=r,e.fillRect(0,0,i,n));var a=t.drawable,o=a&&a.image;if(o){var s=a.rect,h=s[2],l=s[3],c=s[4],u=s[5];if(!h||!l)return;i||n||(i=t.width=h,n=t.height=l),(c||u)&&e.translate(c-.5*h,u-.5*l),e.drawImage(o,s[0],s[1],h,l,0,0,i,n)}},endDraw:function(t){this.context.restore()},transform:function(t){var i=t.drawable;if(i&&i.domElement)return void e.setElementStyleByView(t);var n=this.context,r=t.scaleX,a=t.scaleY;if(t===this.stage){var o=this.canvas.style,s=t._scaleX,h=t._scaleY;(!s&&1!=r||s&&s!=r)&&(t._scaleX=r,o.width=r*t.width+"px"),(!h&&1!=a||h&&h!=a)&&(t._scaleY=a,o.height=a*t.height+"px")}else{var l=t.x,c=t.y,u=t.pivotX,d=t.pivotY,f=t.rotation%360,v=t.mask;v&&(v._render(this),n.clip());var p=t.align;if(p)if("function"==typeof p)t.align();else{var m=t.parent;if(m){var g=t.width,_=t.height,y=m.width,x=m.height;switch(p){case"TL":l=0,c=0;break;case"T":l=y-g>>1,c=0;break;case"TR":l=y-g,c=0;break;case"L":l=0,c=x-_>>1;break;case"C":l=y-g>>1,c=x-_>>1;break;case"R":l=y-g,c=x-_>>1;break;case"BL":l=0,c=x-_;break;case"B":l=y-g>>1,c=x-_;break;case"BR":l=y-g,c=x-_}}}(0!=l||0!=c)&&n.translate(l,c),0!=f&&n.rotate(f*Math.PI/180),(1!=r||1!=a)&&n.scale(r,a),(0!=u||0!=d)&&n.translate(-u,-d)}t.alpha>0&&(n.globalAlpha*=t.alpha)},remove:function(t){var e=t.drawable,i=e&&e.domElement;if(i){var n=i.parentNode;n&&n.removeChild(i)}},clear:function(t,e,i,n){this.context.clearRect(t,e,i,n)},resize:function(t,e){this.canvas.width=t,this.canvas.height=e}});return n}),define("hilo/renderer/DOMRenderer",["hilo/core/Class","hilo/core/Hilo","hilo/renderer/Renderer","hilo/view/Drawable"],function(t,e,i,n){var r=function(){function a(t,i){var n=t.tagName||"div",r=i.image,a=t.width||r&&r.width,o=t.height||r&&r.height,s=e.createElement(n),h=s.style;if(t.id&&(s.id=t.id),h.position="absolute",h.left=(t.left||0)+"px",h.top=(t.top||0)+"px",h.width=a+"px",h.height=o+"px","canvas"==n){if(s.width=a,s.height=o,r){var l=s.getContext("2d"),c=i.rect||[0,0,a,o];l.drawImage(r,c[0],c[1],c[2],c[3],t.x||0,t.y||0,t.width||c[2],t.height||c[3])}}else if(h.opacity=void 0!=t.alpha?t.alpha:1,(t===this.stage||t.clipChildren)&&(h.overflow="hidden"),r&&r.src){h.backgroundImage="url("+r.src+")";var u=t.rectX||0,d=t.rectY||0;h.backgroundPosition=-u+"px "+-d+"px"}return s}return t.create({Extends:i,constructor:function(t){r.superclass.constructor.call(this,t)},startDraw:function(t){var e=t.drawable=t.drawable||new n;return e.domElement=e.domElement||a(t,e),!0},draw:function(t){var e=t.parent,i=t.drawable.domElement,n=i.parentNode;if(e){var r=e.drawable.domElement;r!=n&&r.appendChild(i)}else t!==this.stage||n||(i.style.overflow="hidden",this.canvas.appendChild(i))},transform:function(t){if(e.setElementStyleByView(t),t===this.stage){var i=this.canvas.style,n=t._scaleX,r=t._scaleY,a=t.scaleX,o=t.scaleY;(!n&&1!=a||n&&n!=a)&&(t._scaleX=a,i.width=a*t.width+"px"),(!r&&1!=o||r&&r!=o)&&(t._scaleY=o,i.height=o*t.height+"px")}},remove:function(t){var e=t.drawable,i=e&&e.domElement;if(i){var n=i.parentNode;n&&n.removeChild(i)}},hide:function(t){var e=t.drawable&&t.drawable.domElement;e&&(e.style.display="none")},resize:function(t,e){var i=this.canvas.style;i.width=t+"px",i.height=e+"px","absolute"!=i.position&&(i.position="relative")}})}();return r}),define("hilo/geom/Matrix",["hilo/core/Class"],function(t){var e=t.create({constructor:function(t,e,i,n,r,a){this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=a},concat:function(t){var e=arguments,i=this.a,n=this.b,r=this.c,a=this.d,o=this.tx,s=this.ty;if(e.length>=6)var h=e[0],l=e[1],c=e[2],u=e[3],d=e[4],f=e[5];else h=t.a,l=t.b,c=t.c,u=t.d,d=t.tx,f=t.ty;return this.a=i*h+n*c,this.b=i*l+n*u,this.c=r*h+a*c,this.d=r*l+a*u,this.tx=o*h+s*c+d,this.ty=o*l+s*u+f,this},rotate:function(t){var e=Math.sin(t),i=Math.cos(t),n=this.a,r=this.b,a=this.c,o=this.d,s=this.tx,h=this.ty;return this.a=n*i-r*e,this.b=n*e+r*i,this.c=a*i-o*e,this.d=a*e+o*i,this.tx=s*i-h*e,this.ty=s*e+h*i,this},scale:function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},translate:function(t,e){return this.tx+=t,this.ty+=e,this},identity:function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},invert:function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=this.tx,a=t*n-e*i;return this.a=n/a,this.b=-e/a,this.c=-i/a,this.d=t/a,this.tx=(i*this.ty-n*r)/a,this.ty=-(t*this.ty-e*r)/a,this},transformPoint:function(t,e,i){var n=t.x*this.a+t.y*this.c+this.tx,r=t.x*this.b+t.y*this.d+this.ty;return e&&(n=n+.5>>0,r=r+.5>>0),i?{x:n,y:r}:(t.x=n,t.y=r,t)}});return e}),define("hilo/view/View",["hilo/core/Hilo","hilo/core/Class","hilo/event/EventMixin","hilo/geom/Matrix"],function(t,e,i,n){var r=function(){function r(t,e,i){for(var n,r,a,o,s=0,h=!1,l=0,c=i.length;c>l;l++){var u=i[l],d=i[(l+1)%c];if(u.y==d.y&&e==u.y&&(u.x>d.x?(n=d.x,r=u.x):(n=u.x,r=d.x),t>=n&&r>=t))h=!0;else if(u.y>d.y?(a=d.y,o=u.y):(a=u.y,o=d.y),!(a>e||e>o)){var f=(e-u.y)*(d.x-u.x)/(d.y-u.y)+u.x;if(f>t?s++:f==t&&(h=!0),u.x>t&&u.y==e){var v=i[(c+l-1)%c];(v.y<e&&d.y>e||v.y>e&&d.y<e)&&s++}}}return h||s%2==1}function a(t,e){var i=o(t,e,{overlap:-(1/0),normal:{x:0,y:0}});return i?o(e,t,i):!1}function o(t,e,i){for(var n,r,a,o,s,h,l,c,u,d=t.length,f=e.length,v={x:0,y:0},p=0;d>p;p++){n=t[p],r=t[d-1>p?p+1:0],v.x=n.y-r.y,v.y=r.x-n.x,a=Math.sqrt(v.x*v.x+v.y*v.y),v.x/=a,v.y/=a,o=s=t[0].x*v.x+t[0].y*v.y;for(var m=1;d>m;m++)c=t[m].x*v.x+t[m].y*v.y,c>s?s=c:o>c&&(o=c);for(h=l=e[0].x*v.x+e[0].y*v.y,m=1;f>m;m++)c=e[m].x*v.x+e[m].y*v.y,c>l?l=c:h>c&&(h=c);if(h>o?(u=h-s,v.x=-v.x,v.y=-v.y):u=o-l,u>=0)return!1;u>i.overlap&&(i.overlap=u,i.normal.x=v.x,i.normal.y=v.y)}return i}return e.create({Mixes:i,constructor:function(e){e=e||{},this.id=this.id||e.id||t.getUid("View"),t.copy(this,e,!0)},id:null,x:0,y:0,width:0,height:0,alpha:1,rotation:0,visible:!0,pivotX:0,pivotY:0,scaleX:1,scaleY:1,pointerEnabled:!0,background:null,mask:null,align:null,drawable:null,boundsArea:null,parent:null,depth:-1,getStage:function(){for(var t,e=this;t=e.parent;)e=t;return e.canvas?e:null},getScaledWidth:function(){return this.width*this.scaleX},getScaledHeight:function(){return this.height*this.scaleY},addTo:function(t,e){return"number"==typeof e?t.addChildAt(this,e):t.addChild(this),this},removeFromParent:function(){var t=this.parent;return t&&t.removeChild(this),this},getBounds:function(){for(var t,e,i,n,r,a,o,s=this.width,h=this.height,l=this.getConcatenatedMatrix(),c=this.boundsArea||[{x:0,y:0},{x:s,y:0},{x:s,y:h},{x:0,y:h}],u=[],d=0,f=c.length;f>d;d++)t=l.transformPoint(c[d],!0,!0),e=t.x,i=t.y,0==d?(n=r=e,a=o=i):(n>e?n=e:e>r&&(r=e),a>i?a=i:i>o&&(o=i)),u[d]=t;return u.x=n,u.y=a,u.width=r-n,u.height=o-a,u},getConcatenatedMatrix:function(t){for(var e=new n(1,0,0,1,0,0),i=this;i!=t&&i.parent;i=i.parent){var r=1,a=0,o=i.rotation%360,s=i.pivotX,h=i.pivotY,l=i.scaleX,c=i.scaleY;if(o){var u=o*Math.PI/180;r=Math.cos(u),a=Math.sin(u)}0!=s&&(e.tx-=s),0!=h&&(e.ty-=h),e.concat(r*l,a*l,-a*c,r*c,i.x,i.y)}return e},hitTestPoint:function(t,e,i){var n=this.getBounds(),a=t>=n.x&&t<=n.x+n.width&&e>=n.y&&e<=n.y+n.height;return a&&i&&(a=r(t,e,n)),a},hitTestObject:function(t,e){var i=this.getBounds(),n=t.getBounds(),r=i.x<=n.x+n.width&&n.x<=i.x+i.width&&i.y<=n.y+n.height&&n.y<=i.y+i.height;return r&&e&&(r=a(i,n)),!!r},_render:function(t,e){this.onUpdate&&this.onUpdate(e)===!1||!t.startDraw(this)||(t.transform(this),this.render(t,e),t.endDraw(this))},_fireMouseEvent:function(e){if(e.eventCurrentTarget=this,this.fire(e),"mousemove"==e.type){if(!this.__mouseOver){this.__mouseOver=!0;var i=t.copy({},e);i.type="mouseover",this.fire(i)}}else"mouseout"==e.type&&(this.__mouseOver=!1);var n=this.parent;e._stopped||e._stopPropagationed||!n||("mouseout"==e.type||"touchout"==e.type?n.hitTestPoint(e.stageX,e.stageY,!0)||n._fireMouseEvent(e):n._fireMouseEvent(e))},onUpdate:null,render:function(t,e){t.draw(this)},toString:function(){return t.viewToString(this)}})}();return r}),define("hilo/view/Container",["hilo/core/Hilo","hilo/core/Class","hilo/view/View"],function(t,e,i){var n=e.create({Extends:i,constructor:function(e){e=e||{},this.id=this.id||e.id||t.getUid("Container"),n.superclass.constructor.call(this,e),this.children?this._updateChildren():this.children=[]},children:null,pointerChildren:!0,clipChildren:!1,getNumChildren:function(){return this.children.length},addChildAt:function(t,e){var i=this.children,n=i.length,r=t.parent;e=0>e?0:e>n?n:e;var a=this.getChildIndex(t);if(a==e)return this;if(a>=0?(i.splice(a,1),e=e==n?n-1:e):r&&r.removeChild(t),i.splice(e,0,t),0>a)this._updateChildren(e);else{var o=e>a?a:e,s=e>a?e:a;this._updateChildren(o,s+1)}return this},addChild:function(t){for(var e=this.children.length,i=arguments,n=0,r=i.length;r>n;n++)this.addChildAt(i[n],e+n);return this},removeChildAt:function(t){var e=this.children;if(0>t||t>=e.length)return null;var i=e[t];if(i){if(!i.__renderer)for(var n=i;n=n.parent;){if(n.renderer){i.__renderer=n.renderer;break}if(n.__renderer){i.__renderer=n.__renderer;break}}i.__renderer&&i.__renderer.remove(i),i.parent=null,i.depth=-1}return e.splice(t,1),this._updateChildren(t),i},removeChild:function(t){return this.removeChildAt(this.getChildIndex(t))},removeChildById:function(t){for(var e,i=this.children,n=0,r=i.length;r>n;n++)if(e=i[n],e.id===t)return this.removeChildAt(n),e;return null},removeAllChildren:function(){for(;this.children.length;)this.removeChildAt(0);return this},getChildAt:function(t){var e=this.children;return 0>t||t>=e.length?null:e[t]},getChildById:function(t){for(var e,i=this.children,n=0,r=i.length;r>n;n++)if(e=i[n],e.id===t)return e;return null},getChildIndex:function(t){return this.children.indexOf(t)},setChildIndex:function(t,e){var i=this.children,n=i.indexOf(t);if(n>=0&&n!=e){var r=i.length;e=0>e?0:e>=r?r-1:e,i.splice(n,1),i.splice(e,0,t),this._updateChildren()}return this},swapChildren:function(t,e){var i=this.children,n=this.getChildIndex(t),r=this.getChildIndex(e);t.depth=r,i[r]=t,e.depth=n,i[n]=e},swapChildrenAt:function(t,e){var i=this.children,n=this.getChildAt(t),r=this.getChildAt(e);n.depth=e,i[e]=n,r.depth=t,i[t]=r},sortChildren:function(t){var e=t,i=this.children;if("string"==typeof e){var n=e;e=function(t,e){return e[n]-t[n]}}i.sort(e),this._updateChildren()},_updateChildren:function(t,e){for(var i,n=this.children,t=t||0,e=e||n.length,r=t;e>r;r++)i=n[r],i.depth=r+1,i.parent=this},contains:function(t){for(;t=t.parent;)if(t===this)return!0;return!1},getViewAtPoint:function(t,e,i,n,r){for(var a,o,s=n?[]:null,h=this.children,l=h.length-1;l>=0;l--)if(a=h[l],!(!a||!a.visible||a.alpha<=0||r&&!a.pointerEnabled))if(a.children&&a.children.length&&(!r||a.pointerChildren)&&(o=a.getViewAtPoint(t,e,i,n,r)),o){if(!n)return o;o.length&&(s=s.concat(o))}else if(a.hitTestPoint(t,e,i)){if(!n)return a;s.push(a)}return n&&s.length?s:null},render:function(t,e){n.superclass.render.call(this,t,e);var i,r,a,o=this.children.slice(0);for(i=0,r=o.length;r>i;i++)a=o[i],a.parent===this&&a._render(t,e)}});return n}),define("hilo/view/Stage",["hilo/core/Hilo","hilo/core/Class","hilo/view/Container","hilo/renderer/CanvasRenderer","hilo/renderer/DOMRenderer"],function(t,e,i,n,r){var a=e.create({Extends:i,constructor:function(e){e=e||{},this.id=this.id||e.id||t.getUid("Stage"),a.superclass.constructor.call(this,e),this._initRenderer(e);var i=this.width,n=this.height,r=this.updateViewport();e.width||(i=r&&r.width||320),e.height||(n=r&&r.height||480),this.resize(i,n,!0)},canvas:null,renderer:null,paused:!1,viewport:null,_initRenderer:function(e){var i=this.canvas;"string"==typeof i&&(i=t.getElement(i));var a=e.container;"string"==typeof a&&(a=t.getElement(a)),i||(i=t.createElement("canvas",{style:{position:"absolute"}})),this.canvas=i,a&&a.appendChild(i);var o=i.getContext,s={canvas:i,stage:this};this.renderer=o?new n(s):new r(s)},addTo:function(t){var e=this.canvas;return e.parentNode!==t&&t.appendChild(e),this},tick:function(t){this.paused||this._render(this.renderer,t)},enableDOMEvent:function(t,e){for(var i=this,n=i.canvas,r="string"==typeof t?[t]:t,e=e!==!1,a=i._domListener||(i._domListener=function(t){i._onDOMEvent(t)}),o=0;o<r.length;o++){var t=r[o];e?n.addEventListener(t,a,!1):n.removeEventListener(t,a)}return i},_onDOMEvent:function(e){var i=e.type,n=e,r=0==i.indexOf("touch"),a=e;if(r){var o=e.touches,s=e.changedTouches;a=o&&o.length?o[0]:s&&s.length?s[0]:null}var h=a.pageX||a.clientX,l=a.pageY||a.clientY,c=this.viewport||this.updateViewport();n.stageX=h=(h-c.left)/this.scaleX,n.stageY=l=(l-c.top)/this.scaleY,n.stopPropagation=function(){this._stopPropagationed=!0};var u=this.getViewAtPoint(h,l,!0,!1,!0)||this,d=this.canvas,f=this._eventTarget,v="mouseout"===i;if(f&&(f!=u&&(!f.contains||!f.contains(u))||v)){var p="touchmove"===i?"touchout":"mousemove"===i||v||!u?"mouseout":null;if(p){var m=t.copy({},n);m.type=p,m.eventTarget=f,f._fireMouseEvent(m)}n.lastEventTarget=f,this._eventTarget=null}if(u&&u.pointerEnabled&&"mouseout"!==i&&(n.eventTarget=this._eventTarget=u,u._fireMouseEvent(n)),!r){var g=u&&u.pointerEnabled&&u.useHandCursor?"pointer":"";d.style.cursor=g}t.browser.android&&"touchmove"===i&&e.preventDefault()},updateViewport:function(){var e=this.canvas,i=null;return e.parentNode&&(i=this.viewport=t.getElementRect(e)),i},resize:function(t,e,i){(i||this.width!==t||this.height!==e)&&(this.width=t,this.height=e,this.renderer.resize(t,e),this.updateViewport())}});return a}),define("hilo/view/Bitmap",["hilo/core/Hilo","hilo/core/Class","hilo/view/View","hilo/view/Drawable"],function(t,e,i,n){var r=e.create({Extends:i,constructor:function(e){if(e=e||{},this.id=this.id||e.id||t.getUid("Bitmap"),r.superclass.constructor.call(this,e),this.drawable=new n(e),!this.width||!this.height){var i=this.drawable.rect;i&&(this.width=i[2],this.height=i[3])}},setImage:function(t,e){return this.drawable.init({image:t,rect:e}),e&&(this.width=e[2],this.height=e[3]),this}});return r}),define("hilo/view/Sprite",["hilo/core/Hilo","hilo/core/Class","hilo/view/View","hilo/view/Drawable"],function(t,e,i,n){var r=e.create({Extends:i,constructor:function(e){e=e||{},this.id=this.id||e.id||t.getUid("Sprite"),r.superclass.constructor.call(this,e),this._frames=[],this._frameNames={},this.drawable=new n,e.frames&&this.addFrame(e.frames)},_frames:null,_frameNames:null,_frameElapsed:0,_firstRender:!0,paused:!1,loop:!0,timeBased:!1,interval:1,currentFrame:0,getNumFrames:function(){return this._frames?this._frames.length:0},addFrame:function(t,e){var i=null!=e?e:this._frames.length;if(t instanceof Array)for(var n=0,r=t.length;r>n;n++)this.setFrame(t[n],i+n);else this.setFrame(t,i);return this},setFrame:function(t,e){var i=this._frames,n=i.length;return e=0>e?0:e>n?n:e,i[e]=t,t.name&&(this._frameNames[t.name]=t),(0==e&&!this.width||!this.height)&&(this.width=t.rect[2],this.height=t.rect[3]),this},getFrame:function(t){if("number"==typeof t){var e=this._frames;return 0>t||t>=e.length?null:e[t]}return this._frameNames[t]},getFrameIndex:function(t){var e=this._frames,i=e.length,n=-1;if("number"==typeof t)n=t;else{var r="string"==typeof t?this._frameNames[t]:t;if(r)for(var a=0;i>a;a++)if(r===e[a]){n=a;break}}return n},play:function(){return this.paused=!1,this},stop:function(){return this.paused=!0,this},"goto":function(t,e){var i=this._frames.length,n=this.getFrameIndex(t);return this.currentFrame=0>n?0:n>=i?i-1:n,this.paused=e,this._firstRender=!0,this},_render:function(t,e){var i,n=this.currentFrame;if(this._firstRender?(i=n,this._firstRender=!1):i=this._nextFrame(e),i!=n){this.currentFrame=i;var a=this._frames[i].callback;a&&a.call(this)}this.onEnterFrame&&this.onEnterFrame(i),this.drawable.init(this._frames[i]),r.superclass._render.call(this,t,e)},_nextFrame:function(t){var e=this._frames,i=e.length,n=this.currentFrame,r=e[n],a=r.duration||this.interval,o=this._frameElapsed,s=0!=n||this.drawable?o+(this.timeBased?t:1):0;return o=this._frameElapsed=a>s?s:0,(r.stop||!this.loop&&n>=i-1)&&this.stop(),this.paused||0!=o||(null!=r.next?n=this.getFrameIndex(r.next):n>=i-1?n=0:this.drawable&&n++),n},setFrameCallback:function(t,e){return t=this.getFrame(t),t&&(t.callback=e),this},onEnterFrame:null});return r}),define("hilo/view/DOMElement",["hilo/core/Hilo","hilo/core/Class","hilo/view/View","hilo/view/Drawable"],function(t,e,i,n){var r=e.create({Extends:i,constructor:function(e){e=e||{},this.id=this.id||e.id||t.getUid("DOMElement"),r.superclass.constructor.call(this,e),this.drawable=new n;var i=this.drawable.domElement=e.element||t.createElement("div");i.id=this.id},_render:function(t,e){this.onUpdate&&this.onUpdate(e)===!1||(t.transform(this),this.visible&&this.alpha>0&&this.render(t,e))},render:function(t,e){var i=t.canvas;if(i.getContext){var n,r=this.drawable.domElement,a=this.depth,o=i.nextSibling;if(r.parentNode)return;for(;o&&3!=o.nodeType&&(n=parseInt(o.style.zIndex)||0,!(0>=n||n>a));)o=o.nextSibling;i.parentNode.insertBefore(this.drawable.domElement,o)}else t.draw(this)}});return r}),define("hilo/view/Graphics",["hilo/core/Hilo","hilo/core/Class","hilo/view/View"],function(t,e,i){var n=function(){var r=document.createElement("canvas"),a=r.getContext&&r.getContext("2d");return e.create({Extends:i,constructor:function(e){e=e||{},this.id=this.id||e.id||t.getUid("Graphics"),n.superclass.constructor.call(this,e),this._actions=[],this._cache=null},lineWidth:1,lineAlpha:1,lineCap:null,lineJoin:null,miterLimit:10,hasStroke:!1,strokeStyle:"0",hasFill:!1,fillStyle:"0",fillAlpha:0,lineStyle:function(t,e,i,n,r,a){var o=this,s=o._addAction;return s.call(o,["lineWidth",o.lineWidth=t||1]),s.call(o,["strokeStyle",o.strokeStyle=e||"0"]),s.call(o,["lineAlpha",o.lineAlpha=i||1]),void 0!=n&&s.call(o,["lineCap",o.lineCap=n]),void 0!=r&&s.call(o,["lineJoin",o.lineJoin=r]),void 0!=a&&s.call(o,["miterLimit",o.miterLimit=a]),o.hasStroke=!0,o},beginFill:function(t,e){var i=this,n=i._addAction;return n.call(i,["fillStyle",i.fillStyle=t]),n.call(i,["fillAlpha",i.fillAlpha=e||1]),i.hasFill=!0,i},endFill:function(){var t=this,e=t._addAction;return t.hasStroke&&e.call(t,["stroke"]),t.hasFill&&e.call(t,["fill"]),t},beginLinearGradientFill:function(t,e,i,n,r,o){for(var s=this,h=a.createLinearGradient(t,e,i,n),l=0,c=r.length;c>l;l++)h.addColorStop(o[l],r[l]);return s.hasFill=!0,s._addAction(["fillStyle",s.fillStyle=h])},beginRadialGradientFill:function(t,e,i,n,r,o,s,h){for(var l=this,c=a.createRadialGradient(t,e,i,n,r,o),u=0,d=s.length;d>u;u++)c.addColorStop(h[u],s[u]);return l.hasFill=!0,l._addAction(["fillStyle",l.fillStyle=c])},beginBitmapFill:function(t,e){var i=this,n=a.createPattern(t,e||"");return i.hasFill=!0,i._addAction(["fillStyle",i.fillStyle=n])},beginPath:function(){return this._addAction(["beginPath"])},closePath:function(){return this._addAction(["closePath"])},moveTo:function(t,e){return this._addAction(["moveTo",t,e])},lineTo:function(t,e){return this._addAction(["lineTo",t,e])},quadraticCurveTo:function(t,e,i,n){return this._addAction(["quadraticCurveTo",t,e,i,n])},bezierCurveTo:function(t,e,i,n,r,a){return this._addAction(["bezierCurveTo",t,e,i,n,r,a])},drawRect:function(t,e,i,n){return this._addAction(["rect",t,e,i,n])},drawRoundRectComplex:function(t,e,i,n,r,a,o,s){var h=this,l=h._addAction;return l.call(h,["moveTo",t+r,e]),l.call(h,["lineTo",t+i-a,e]),l.call(h,["arc",t+i-a,e+a,a,-Math.PI/2,0,!1]),l.call(h,["lineTo",t+i,e+n-o]),l.call(h,["arc",t+i-o,e+n-o,o,0,Math.PI/2,!1]),l.call(h,["lineTo",t+s,e+n]),l.call(h,["arc",t+s,e+n-s,s,Math.PI/2,Math.PI,!1]),l.call(h,["lineTo",t,e+r]),l.call(h,["arc",t+r,e+r,r,Math.PI,3*Math.PI/2,!1]),h},drawRoundRect:function(t,e,i,n,r){return this.drawRoundRectComplex(t,e,i,n,r,r,r,r)},drawCircle:function(t,e,i){return this._addAction(["arc",t+i,e+i,i,0,2*Math.PI,0])},drawEllipse:function(t,e,i,n){var r=this;if(i==n)return r.drawCircle(t,e,i);var a=r._addAction,o=i/2,s=n/2,h=.5522847498307933,l=h*o,c=h*s;return t+=o,e+=s,a.call(r,["moveTo",t+o,e]),a.call(r,["bezierCurveTo",t+o,e-c,t+l,e-s,t,e-s]),a.call(r,["bezierCurveTo",t-l,e-s,t-o,e-c,t-o,e]),a.call(r,["bezierCurveTo",t-o,e+c,t-l,e+s,t,e+s]),a.call(r,["bezierCurveTo",t+l,e+s,t+o,e+c,t+o,e]),r},drawSVGPath:function(t){var e=this,i=e._addAction,n=t.split(/,| (?=[a-zA-Z])/);i.call(e,["beginPath"]);for(var r=0,a=n.length;a>r;r++){var o=n[r],s=o[0].toUpperCase(),h=o.substring(1).split(/,| /);switch(0==h[0].length&&h.shift(),s){case"M":i.call(e,["moveTo",h[0],h[1]]);break;case"L":i.call(e,["lineTo",h[0],h[1]]);break;case"C":i.call(e,["bezierCurveTo",h[0],h[1],h[2],h[3],h[4],h[5]]);break;case"Z":i.call(e,["closePath"])}}return e},_draw:function(t){var e,i=this,n=i._actions,r=n.length;for(t.beginPath(),e=0;r>e;e++){var a=n[e],o=a[0],s=a.length>1?a.slice(1):null;"function"==typeof t[o]?t[o].apply(t,s):t[o]=a[1]}},render:function(t,e){var i=this,n=t.canvas;if(n.getContext)i._draw(t.context);else{var r=i.drawable;r.image||(r.image=i.toImage()),t.draw(i)}},cache:function(e){var i=this,n=i._cache;return n||(n=i._cache=t.createElement("canvas",{width:i.width,height:i.height}),i._draw(n.getContext("2d"))),e&&(n=i._cache=i.toImage()),n},uncache:function(){this._cache=null},toImage:function(e){var i=this,n=i._cache,r=i.width,a=i.height;if(n||(n=t.createElement("canvas",{width:r,height:a}),i._draw(n.getContext("2d"))),!(n instanceof HTMLImageElement)){var o=n.toDataURL(e||"image/png");n=new Image,n.src=o,n.width=r,n.height=a}return n},clear:function(){var t=this;return t._actions.length=0,t._cache=null,t.lineWidth=1,t.lineAlpha=1,t.lineCap=null,t.lineJoin=null,t.miterLimit=10,t.hasStroke=!1,t.strokeStyle="0",t.hasFill=!1,t.fillStyle="0",t.fillAlpha=1,t},_addAction:function(t){var e=this;return e._actions.push(t),e}})}();return n}),define("hilo/view/Text",["hilo/core/Class","hilo/core/Hilo","hilo/view/View"],function(t,e,i){var n=t.create({Extends:i,constructor:function(t){t=t||{},this.id=this.id||t.id||e.getUid("Text"),n.superclass.constructor.call(this,t),t.font||(this.font="12px arial"),this._fontHeight=n.measureFontHeight(this.font)},text:null,color:"#000",textAlign:null,textVAlign:null,outline:!1,lineSpacing:0,maxWidth:200,font:null,textWidth:0,textHeight:0,setFont:function(t){var e=this;return e.font!==t&&(e.font=t,e._fontHeight=n.measureFontHeight(t)),e},render:function(t,e){var i=this,n=t.canvas;if(n.getContext)i._draw(t.context);else{var r=i.drawable,a=r.domElement,o=a.style;o.font=i.font,o.textAlign=i.textAlign,o.color=i.color,o.width=i.width+"px",o.height=i.height+"px",o.lineHeight=i._fontHeight+i.lineSpacing+"px",a.innerHTML=i.text,t.draw(this)}},_draw:function(t){var e=this,i=e.text.toString();if(i){t.font=e.font,t.textAlign=e.textAlign,t.textBaseline="top";var n,r,a,o=i.split(/\r\n|\r|\n|<br(?:[ \/])*>/),s=0,h=0,l=e._fontHeight+e.lineSpacing,c=[];for(n=0,len=o.length;n<len;n++)if(r=o[n],a=t.measureText(r).width,a<=e.maxWidth)c.push({text:r,y:h}),a>s&&(s=a),h+=l;else{var u,d,f,v="",p=0;for(d=0,wlen=r.length;d<wlen;d++)f=r[d],u=t.measureText(v+f).width,u>e.maxWidth?(c.push({text:v,y:h}),p>s&&(s=p),h+=l,v=f):(p=u,v+=f),d==wlen-1&&(c.push({text:v,y:h}),v!==f&&u>s&&(s=u),h+=l)}e.textWidth=s,e.textHeight=h,e.width||(e.width=s),e.height||(e.height=h);var m=0;switch(e.textVAlign){case"middle":m=e.height-e.textHeight>>1;break;case"bottom":m=e.height-e.textHeight}var g=e.background;g&&(t.fillStyle=g,t.fillRect(0,0,e.width,e.height)),e.outline?t.strokeStyle=e.color:t.fillStyle=e.color;for(var n=0;n<c.length;n++){var r=c[n];e._drawTextLine(t,r.text,m+r.y)}}},_drawTextLine:function(t,e,i){var n=this,r=0,a=n.width;switch(n.textAlign){case"center":r=a>>1;break;case"right":case"end":r=a}n.outline?t.strokeText(e,r,i):t.fillText(e,r,i)},Statics:{measureFontHeight:function(t){var i,n=document.documentElement,r=e.createElement("div",{style:{font:t,position:"absolute"},innerHTML:"M"});return n.appendChild(r),i=r.offsetHeight,n.removeChild(r),i}}});return n}),define("hilo/view/BitmapText",["hilo/core/Class","hilo/core/Hilo","hilo/view/Container","hilo/view/Bitmap"],function(t,e,i,n){
var r=t.create({Extends:i,constructor:function(t){t=t||{},this.id=this.id||t.id||e.getUid("BitmapText"),r.superclass.constructor.call(this,t);var i=t.text+"";i&&(this.text="",this.setText(i)),this.pointerChildren=!1},glyphs:null,letterSpacing:0,text:"",textAlign:"left",setText:function(t){var e=this,i=t.toString(),n=i.length;if(e.text!=i){e.text=i;var r,a,o,s,h=0,l=0,c=0;for(r=0;n>r;r++)a=i.charAt(r),o=e.glyphs[a],o&&(c=h+(h>0?e.letterSpacing:0),e.children[r]?(s=e.children[r],s.setImage(o.image,o.rect)):(s=e._createBitmap(o),e.addChild(s)),s.x=c,h=c+o.rect[2],l=Math.max(l,o.rect[3]));for(r=e.children.length-1;r>=n;r--)e._releaseBitmap(e.children[r]),e.children[r].removeFromParent();return e.width=h,e.height=l,this.setTextAlign(),e}},_createBitmap:function(t){var e;return r._pool.length?(e=r._pool.pop(),e.setImage(t.image,t.rect)):e=new n({image:t.image,rect:t.rect}),e},_releaseBitmap:function(t){r._pool.push(t)},setTextAlign:function(t){switch(this.textAlign=t||this.textAlign,this.textAlign){case"center":this.pivotX=.5*this.width;break;case"right":this.pivotX=this.width;break;case"left":default:this.pivotX=0}return this},hasGlyphs:function(t){var e=this.glyphs;if(!e)return!1;var i,t=t.toString(),n=t.length;for(i=0;n>i;i++)if(!e[t.charAt(i)])return!1;return!0},Statics:{_pool:[],createGlyphs:function(t,e,i,n){var r=t.toString();i=i||r.length,n=n||1;for(var a=e.width/i,o=e.height/n,s={},h=0,l=t.length;l>h;h++)charStr=r.charAt(h),s[charStr]={image:e,rect:[a*(h%i),o*Math.floor(h/i),a,o]};return s}}});return r}),define("hilo/view/Button",["hilo/core/Hilo","hilo/core/Class","hilo/view/View","hilo/view/Drawable"],function(t,e,i,n){var r=e.create({Extends:i,constructor:function(e){e=e||{},this.id=this.id||e.id||t.getUid("Button"),r.superclass.constructor.call(this,e),this.drawable=new n(e),this.setState(r.UP)},upState:null,overState:null,downState:null,disabledState:null,state:null,enabled:!0,useHandCursor:!0,setEnabled:function(t){return this.enabled!=t&&(t?this.setState(r.UP):this.setState(r.DISABLED)),this},setState:function(e){if(this.state!==e){this.state=e,this.pointerEnabled=this.enabled=e!==r.DISABLED;var i;switch(e){case r.UP:i=this.upState;break;case r.OVER:i=this.overState;break;case r.DOWN:i=this.downState;break;case r.DISABLED:i=this.disabledState}i&&(this.drawable.init(i),t.copy(this,i,!0))}return this},fire:function(t,e){if(this.enabled){var i="string"==typeof t?t:t.type;switch(i){case"mousedown":case"touchstart":case"touchmove":this.setState(r.DOWN);break;case"mouseover":this.setState(r.OVER);break;case"mouseup":this.overState?this.setState(r.OVER):this.upState&&this.setState(r.UP);break;case"touchend":case"touchout":case"mouseout":this.setState(r.UP)}return r.superclass.fire.call(this,t,e)}},Statics:{UP:"up",OVER:"over",DOWN:"down",DISABLED:"disabled"}});return r}),define("hilo/util/TextureAtlas",["hilo/core/Class"],function(t){var e=function(){function e(t){var e=t.frames;if(!e)return null;var i,n=[];if(e instanceof Array)for(var r=0,a=e.length;a>r;r++)i=e[r],n[r]={image:t.image,rect:i};else for(var o=e.frameWidth,s=e.frameHeight,h=t.width/o|0,l=t.height/s|0,c=e.numFrames||h*l,r=0;c>r;r++)n[r]={image:t.image,rect:[r%h*o,(r/h|0)*s,o,s]};return n}function i(t,e){var i=t.sprites;if(!i)return null;var a,o,s,h={};for(var l in i){if(a=i[l],r(a))o=n(e[a]);else if(a instanceof Array){o=[];for(var c=0,u=a.length;u>c;c++){var d,f=a[c];r(f)?s=n(e[f]):(d=f.rect,r(d)&&(d=e[f.rect]),s=n(d,f)),o[c]=s}}else{o=[];for(var c=a.from;c<=a.to;c++)o[c-a.from]=n(e[c],a[c])}h[l]=o}return h}function n(t,e){var i={image:t.image,rect:t.rect};return e&&(i.name=e.name||null,i.duration=e.duration||0,i.stop=!!e.stop,i.next=e.next||null),i}function r(t){return"number"==typeof t}return t.create({constructor:function(t){this._frames=e(t),this._sprites=i(t,this._frames)},_frames:null,_sprites:null,getFrame:function(t){var e=this._frames;return e&&e[t]},getSprite:function(t){var e=this._sprites;return e&&e[t]},Statics:{createSpriteFrames:function(t,e,i,n,r,a,o){if("[object Array]"===Object.prototype.toString.call(t)){for(var e=[],s=0,h=t.length;h>s;s++)e=e.concat(this.createSpriteFrames.apply(this,t[s]));return e}if("string"==typeof e){var l=e.split(",");e=[];for(var c=0,u=l.length;u>c;c++){var d=l[c].split("-");if(1==d.length)e.push(parseInt(d[0]));else for(var s=parseInt(d[0]),h=parseInt(d[1]);h>=s;s++)e.push(s)}}for(var f=Math.floor(i.width/n),s=0;s<e.length;s++){var v=e[s];e[s]={rect:[n*(v%f),r*Math.floor(v/f),n,r],image:i,duration:o}}return e[0].name=t,a?e[e.length-1].next=t:e[e.length-1].stop=!0,e}}})}();return e}),define("hilo/util/Ticker",["hilo/core/Class","hilo/core/Hilo"],function(t,e){var i=t.create({constructor:function(t){this._targetFPS=t||30,this._interval=1e3/this._targetFPS,this._tickers=[]},_paused:!1,_targetFPS:0,_interval:0,_intervalId:null,_tickers:null,_lastTime:0,_tickCount:0,_tickTime:0,_measuredFPS:0,start:function(t){if(!this._intervalId){this._lastTime=+new Date;var i=this,n=this._interval,r=window.requestAnimationFrame||window[e.browser.jsVendor+"RequestAnimationFrame"];if(t&&r)var a=function(){i._tick()},o=function(){i._intervalId=setTimeout(o,n),r(a)};else o=function(){i._intervalId=setTimeout(o,n),i._tick()};o()}},stop:function(){clearTimeout(this._intervalId),this._intervalId=null,this._lastTime=0},pause:function(){this._paused=!0},resume:function(){this._paused=!1},_tick:function(){if(!this._paused){var t=+new Date,e=t-this._lastTime,i=this._tickers;++this._tickCount>=this._targetFPS?(this._measuredFPS=1e3/(this._tickTime/this._tickCount)+.5>>0,this._tickCount=0,this._tickTime=0):this._tickTime+=t-this._lastTime,this._lastTime=t;for(var n=0,r=i.length;r>n;n++)i[n].tick(e)}},getMeasuredFPS:function(){return this._measuredFPS},addTick:function(t){if(!t||"function"!=typeof t.tick)throw new Error("Ticker: The tick object must implement the tick method.");this._tickers.push(t)},removeTick:function(t){var e=this._tickers,i=e.indexOf(t);i>=0&&e.splice(i,1)}});return i}),define(function(){var t=Array.prototype,e=t.slice;t.indexOf=t.indexOf||function(t,e){e=e||0;var i,n=this.length;if(0==n||e>=n)return-1;for(0>e&&(e=n+e),i=e;n>i;i++)if(this[i]===t)return i;return-1};var i=Function.prototype;i.bind=i.bind||function(t){function i(){var a=r.concat(e.call(arguments));return n.apply(this instanceof i?this:t,a)}var n=this,r=e.call(arguments,1),a=function(){};return a.prototype=n.prototype,i.prototype=new a,i}}),define("hilo/util/drag",["hilo/core/Class","hilo/core/Hilo"],function(t,e){var i={startDrag:function(t){function i(t){t.stopPropagation(),a(t),h.off(e.event.POINTER_START,i),h.fire("dragStart",l),h.__dragX=h.x-l.x,h.__dragY=h.y-l.y,s||(s=this.getStage()),s.on(e.event.POINTER_MOVE,r),document.addEventListener(e.event.POINTER_END,n)}function n(t){document.removeEventListener(e.event.POINTER_END,n),s&&s.off(e.event.POINTER_MOVE,r),h.fire("dragEnd",l),h.on(e.event.POINTER_START,i)}function r(t){a(t),h.fire("dragMove",l);var e=l.x+h.__dragX,i=l.y+h.__dragY;h.x=Math.max(c,Math.min(d,e)),h.y=Math.max(u,Math.min(f,i))}function a(t){l.preX=l.x,l.preY=l.y,l.x=t.stageX,l.y=t.stageY}function o(){document.removeEventListener(e.event.POINTER_END,n),s&&s.off(e.event.POINTER_MOVE,r),h.off(e.event.POINTER_START,i)}var s,h=this,t=t||[-(1/0),-(1/0),1/0,1/0],l={x:0,y:0,preX:0,preY:0},c=t[0],u=t[1],d=t[2]==1/0?1/0:c+t[2],f=t[3]==1/0?1/0:u+t[3];h.on(e.event.POINTER_START,i),h.stopDrag=o},stopDrag:function(){}};return i}),define("hilo/tween/Tween",["hilo/core/Class"],function(t){var e=function(){function i(){return+new Date}return t.create({constructor:function(t,e,i,n){var r=this;r.target=t,r._startTime=0,r._seekTime=0,r._pausedTime=0,r._pausedStartTime=0,r._reverseFlag=1,r._repeatCount=0,3==arguments.length&&(n=i,i=e,e=null);for(var a in n)r[a]=n[a];r.setProps(e,i),!n.duration&&n.time&&(r.duration=n.time||0,r.time=0)},target:null,duration:0,delay:0,paused:!1,loop:!1,reverse:!1,repeat:0,repeatDelay:0,ease:null,time:0,onStart:null,onUpdate:null,onComplete:null,setProps:function(t,e){var i=this,n=i.target,r=t||e,a=i._fromProps={},o=i._toProps={};t=t||n,e=e||n;for(var s in r)o[s]=e[s]||0,n[s]=a[s]=t[s]||0;return i},start:function(){var t=this;return t._startTime=i()+t.delay,t._seekTime=0,t._pausedTime=0,t.paused=!1,e.add(t),t},stop:function(){return e.remove(this),this},pause:function(){var t=this;return t.paused=!0,t._pausedStartTime=i(),t},resume:function(){var t=this;return t.paused=!1,t._pausedStartTime&&(t._pausedTime+=i()-t._pausedStartTime),t._pausedStartTime=0,t},seek:function(t,n){var r=this,a=i();return r._startTime=a,r._seekTime=t,r._pausedTime=0,void 0!==n&&(r.paused=n),r._update(a,!0),e.add(r),r},link:function(t){var i=this,n=t.delay,r=i._startTime;if("string"==typeof n){var a=0==n.indexOf("+"),o=0==n.indexOf("-");n=a||o?Number(n.substr(1))*(a?1:-1):Number(n)}return t.delay=n,t._startTime=a||o?r+i.duration+n:r+n,i._next=t,e.remove(t),i},_render:function(t){var e,i=this,n=i.target,r=i._fromProps;for(e in r)n[e]=r[e]+(i._toProps[e]-r[e])*t},_update:function(t,n){var r=this;if(!r.paused||n){var a=t-r._startTime-r._pausedTime+r._seekTime;if(!(0>a)){var o,s=a/r.duration,h=!1;s=0>=s?0:s>=1?1:r.ease?r.ease(s):s,r.reverse&&(r._reverseFlag<0&&(s=1-s),1e-7>s&&(r.repeat>0&&r._repeatCount++>=r.repeat||0==r.repeat&&!r.loop?h=!0:(r._startTime=i(),r._pausedTime=0,r._reverseFlag*=-1))),0==r.time&&(o=r.onStart)&&o.call(r,r),r.time=a,r._render(s),(o=r.onUpdate)&&o.call(r,s,r),s>=1&&(r.reverse?(r._startTime=i(),r._pausedTime=0,r._reverseFlag*=-1):r.loop||r.repeat>0&&r._repeatCount++<r.repeat?(r._startTime=i()+r.repeatDelay,r._pausedTime=0):h=!0);var l=r._next;if(l&&l.time<=0){var c=l._startTime;c>0&&t>=c?(l._render(s),l.time=a,e.add(l)):h&&(0>c||c>t)&&l.start()}return h?((o=r.onComplete)&&o.call(r,r),!0):void 0}}},Statics:{_tweens:[],tick:function(){var t,n,r=e._tweens,a=r.length;for(n=0;a>n;n++)t=r[n],t&&t._update(i())&&(r.splice(n,1),n--);return e},add:function(t){var i=e._tweens;return-1==i.indexOf(t)&&i.push(t),e},remove:function(t){if(t instanceof Array){for(var i=0,n=t.length;n>i;i++)e.remove(t[i]);return e}var i,r=e._tweens;if(t instanceof e)i=r.indexOf(t),i>-1&&r.splice(i,1);else for(i=0;i<r.length;i++)r[i].target===t&&(r.splice(i,1),i--);return e},removeAll:function(){return e._tweens.length=0,e},fromTo:function(t,i,n,r){var a=t instanceof Array;t=a?t:[t];var o,s,h=r.stagger,l=[];for(s=0;s<t.length;s++)o=new e(t[s],i,n,r),h&&(o.delay=(r.delay||0)+(s*h||0)),o.start(),l.push(o);return a?l:o},to:function(t,i,n){return e.fromTo(t,null,i,n)},from:function(t,i,n){return e.fromTo(t,i,null,n)}}})}();return e}),define("hilo/tween/Ease",function(){var t=function(){function t(t,e,i,n,r){return t=t||{},e&&(t.EaseIn=e),i&&(t.EaseOut=i),n&&(t.EaseInOut=n),r&&(t.EaseNone=r),t}var e=t(null,null,null,null,function(t){return t}),i=t(null,function(t){return t*t},function(t){return-t*(t-2)},function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}),n=t(null,function(t){return t*t*t},function(t){return--t*t*t+1},function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}),r=t(null,function(t){return t*t*t*t},function(t){return-(--t*t*t*t-1)},function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}),a=t(null,function(t){return t*t*t*t*t},function(t){return(t-=1)*t*t*t*t+1},function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}),o=Math,s=o.PI,h=.5*s,l=o.sin,c=o.cos,u=o.pow,d=o.sqrt,f=t(null,function(t){return-c(t*h)+1},function(t){return l(t*h)},function(t){return-.5*(c(s*t)-1)}),v=t(null,function(t){return 0==t?0:u(2,10*(t-1))},function(t){return 1==t?1:-u(2,-10*t)+1},function(t){return 0==t||1==t?t:(t*=2)<1?.5*u(2,10*(t-1)):.5*(-u(2,-10*(t-1))+2)}),p=t(null,function(t){return-(d(1-t*t)-1)},function(t){return d(1- --t*t)},function(t){return(t/=.5)<1?-.5*(d(1-t*t)-1):.5*(d(1-(t-=2)*t)+1)}),m=t({a:1,p:.4,s:.1,config:function(t,e){m.a=t,m.p=e,m.s=e/(2*s)*Math.asin(1/t)||0}},function(t){return-(m.a*u(2,10*(t-=1))*l((t-m.s)*(2*s)/m.p))},function(t){return m.a*u(2,-10*t)*l((t-m.s)*(2*s)/m.p)+1},function(t){return(t*=2)<1?-.5*(m.a*u(2,10*(t-=1))*l((t-m.s)*(2*s)/m.p)):m.a*u(2,-10*(t-=1))*l((t-m.s)*(2*s)/m.p)*.5+1}),g=t({o:1.70158,s:2.59491,config:function(t){g.o=t,g.s=1.525*t}},function(t){return t*t*((g.o+1)*t-g.o)},function(t){return(t-=1)*t*((g.o+1)*t+g.o)+1},function(t){return(t*=2)<1?.5*(t*t*((g.s+1)*t-g.s)):.5*((t-=2)*t*((g.s+1)*t+g.s)+2)}),_=t(null,function(t){return 1-_.EaseOut(1-t)},function(t){return(t/=1)<.36364?7.5625*t*t:.72727>t?7.5625*(t-=.54545)*t+.75:.90909>t?7.5625*(t-=.81818)*t+.9375:7.5625*(t-=.95455)*t+.984375},function(t){return.5>t?.5*_.EaseIn(2*t):.5*_.EaseOut(2*t-1)+.5});return{Linear:e,Quad:i,Cubic:n,Quart:r,Quint:a,Sine:f,Expo:v,Circ:p,Elastic:m,Back:g,Bounce:_}}();return t}),define("hilo/loader/ImageLoader",["hilo/core/Class"],function(t){var e=t.create({load:function(t){var e=this,i=new Image;t.crossOrigin&&(i.crossOrigin=t.crossOrigin),i.onload=function(){e.onLoad(i)},i.onerror=i.onabort=e.onError.bind(i),i.src=t.src+(t.noCache?(-1==t.src.indexOf("?")?"?":"&")+"t="+ +new Date:"")},onLoad:function(t){t=t||window.event;var e=t;return e.onload=e.onerror=e.onabort=null,e},onError:function(t){var e=t.target;return e.onload=e.onerror=e.onabort=null,t}});return e}),define("hilo/loader/ScriptLoader",["hilo/core/Class"],function(t){var e=t.create({load:function(t){var i=this,n=t.src,r="jsonp"==t.type;if(r){var a=t.callbackName||"callback",o=t.callback||"jsonp"+ ++e._count,s=window;s[o]||(s[o]=function(t){delete s[o]})}r&&(n+=(-1==n.indexOf("?")?"?":"&")+a+"="+o),t.noCache&&(n+=(-1==n.indexOf("?")?"?":"&")+"t="+ +new Date);var h=document.createElement("script");h.type="text/javascript",h.async=!0,h.onload=i.onLoad.bind(i),h.onerror=i.onError.bind(i),h.src=n,t.id&&(h.id=t.id),document.getElementsByTagName("head")[0].appendChild(h)},onLoad:function(t){var e=t.target;return e.onload=e.onerror=null,e},onError:function(t){var e=t.target;return e.onload=e.onerror=null,t},Statics:{_count:0}});return e}),define("hilo/loader/LoadQueue",["hilo/core/Class","hilo/event/EventMixin","hilo/loader/ImageLoader","hilo/loader/ScriptLoader"],function(t,e,i,n){function r(t){var e,i,n=/\/?[^\/]+\.(\w+)(\?\S+)?$/i;return(e=t.match(n))&&(i=e[1].toLowerCase()),i||null}var a=t.create({Mixes:e,constructor:function(t){this._source=[],this.add(t)},maxConnections:2,_source:null,_loaded:0,_connections:0,_currentIndex:-1,add:function(t){var e=this;return t&&(t=t instanceof Array?t:[t],e._source=e._source.concat(t)),e},get:function(t){if(t)for(var e=this._source,i=0;i<e.length;i++){var n=e[i];if(n.id===t||n.src===t)return n}return null},getContent:function(t){var e=this.get(t);return e&&e.content},start:function(){var t=this;return t._loadNext(),t},_loadNext:function(){var t=this,e=t._source,i=e.length;if(t._loaded>=i)return void t.fire("complete");if(t._currentIndex<i-1&&t._connections<t.maxConnections){var n=++t._currentIndex,r=e[n],a=t._getLoader(r);if(a){var o=a.onLoad,s=a.onError;a.onLoad=function(e){a.onLoad=o,a.onError=s;var i=o&&o.call(a,e)||e.target;t._onItemLoad(n,i)},a.onError=function(e){a.onLoad=o,a.onError=s,s&&s.call(a,e),t._onItemError(n,e)},t._connections++}t._loadNext(),a&&a.load(r)}},_getLoader:function(t){var e=t.loader;if(e)return e;var a=t.type||r(t.src);switch(a){case"png":case"jpg":case"jpeg":case"gif":e=new i;break;case"js":case"jsonp":e=new n}return e},_onItemLoad:function(t,e){var i=this,n=i._source[t];n.loaded=!0,n.content=e,i._connections--,i._loaded++,i.fire("load",n),i._loadNext()},_onItemError:function(t,e){var i=this,n=i._source[t];n.error=e,i._connections--,i._loaded++,i.fire("error",n),i._loadNext()},getSize:function(t){for(var e=0,i=this._source,n=0;n<i.length;n++){var r=i[n];e+=(t?r.loaded&&r.size:r.size)||0}return e},getLoaded:function(){return this._loaded},getTotal:function(){return this._source.length}});return a}),define("hilo/media/HTMLAudio",["hilo/core/Hilo","hilo/core/Class","hilo/event/EventMixin"],function(t,e,i){var n=e.create({Mixes:i,constructor:function(e){t.copy(this,e,!0),this._onAudioEvent=this._onAudioEvent.bind(this)},src:null,loop:!1,autoPlay:!1,loaded:!1,playing:!1,duration:0,volume:1,muted:!1,_element:null,load:function(){if(!this._element)try{var t=this._element=new Audio;t.addEventListener("canplaythrough",this._onAudioEvent,!1),t.addEventListener("ended",this._onAudioEvent,!1),t.addEventListener("error",this._onAudioEvent,!1),t.src=this.src,t.volume=this.volume,t.load()}catch(e){var t=this._element={};t.play=t.pause=function(){}}return this},_onAudioEvent:function(t){var e=t.type;switch(e){case"canplaythrough":t.target.removeEventListener(e,this._onAudioEvent),this.loaded=!0,this.duration=this._element.duration,this.fire("load"),this.autoPlay&&this._doPlay();break;case"ended":this.playing=!1,this.fire("end"),this.loop&&this._doPlay();break;case"error":this.fire("error")}},_doPlay:function(){this.playing||(this._element.volume=this.muted?0:this.volume,this._element.play(),this.playing=!0)},play:function(){return this.playing&&this.stop(),this._element?this.loaded&&this._doPlay():(this.autoPlay=!0,this.load()),this},pause:function(){return this.playing&&(this._element.pause(),this.playing=!1),this},resume:function(){return this.playing||this._doPlay(),this},stop:function(){return this.playing&&(this._element.pause(),this._element.currentTime=0,this.playing=!1),this},setVolume:function(t){return this.volume!=t&&(this.volume=t,this._element.volume=t),this},setMute:function(t){return this.muted!=t&&(this.muted=t,this._element.volume=t?0:this.volume),this},Statics:{isSupported:null!==window.Audio}});return n}),define("hilo/media/WebAudio",["hilo/core/Hilo","hilo/core/Class","hilo/event/EventMixin"],function(t,e,i){var n=function(){var n=window.AudioContext||window.webkitAudioContext,r=n?new n:null;return e.create({Mixes:i,constructor:function(e){t.copy(this,e,!0),this._init()},src:null,loop:!1,autoPlay:!1,loaded:!1,playing:!1,duration:0,volume:1,muted:!1,_context:null,_gainNode:null,_buffer:null,_audioNode:null,_startTime:0,_offset:0,_init:function(){this._context=r,this._gainNode=r.createGain?r.createGain():r.createGainNode(),this._gainNode.connect(r.destination),this._onAudioEvent=this._onAudioEvent.bind(this),this._onDecodeComplete=this._onDecodeComplete.bind(this),this._onDecodeError=this._onDecodeError.bind(this)},load:function(){if(!this._buffer){var t=new XMLHttpRequest;t.src=this.src,t.open("GET",this.src,!0),t.responseType="arraybuffer",t.onload=this._onAudioEvent,t.onprogress=this._onAudioEvent,t.onerror=this._onAudioEvent,t.send(),this._buffer=!0}return this},_onAudioEvent:function(t){var e=t.type;switch(e){case"load":var i=t.target;i.onload=i.onprogress=i.onerror=null,this._context.decodeAudioData(i.response,this._onDecodeComplete,this._onDecodeError),i=null;break;case"ended":this.playing=!1,this.fire("end"),this.loop&&this._doPlay();break;case"progress":this.fire(t);break;case"error":this.fire(t)}},_onDecodeComplete:function(t){this._buffer=t,this.loaded=!0,this.duration=t.duration,this.fire("load"),this.autoPlay&&this._doPlay()},_onDecodeError:function(){this.fire("error")},_doPlay:function(){this._clearAudioNode();var t=this._context.createBufferSource();t.start||(t.start=t.noteOn,t.stop=t.noteOff),t.buffer=this._buffer,t.onended=this._onAudioEvent,this._gainNode.gain.value=this.muted?0:this.volume,t.connect(this._gainNode),t.start(0,this._offset),this._audioNode=t,this._startTime=this._context.currentTime,this.playing=!0},_clearAudioNode:function(){var t=this._audioNode;t&&(t.onended=null,t.disconnect(0),this._audioNode=null)},play:function(){return this.playing&&this.stop(),this.loaded?this._doPlay():this._buffer||(this.autoPlay=!0,this.load()),this},pause:function(){return this.playing&&(this._audioNode.stop(0),this._offset+=this._context.currentTime-this._startTime,this.playing=!1),this},resume:function(){return this.playing||this._doPlay(),this},stop:function(){return this.playing&&(this._audioNode.stop(0),this._audioNode.disconnect(),this._offset=0,this.playing=!1),this},setVolume:function(t){return this.volume!=t&&(this.volume=t,this._gainNode.gain.value=t),this},setMute:function(t){return this.muted!=t&&(this.muted=t,this._gainNode.gain.value=t?0:this.volume),this},Statics:{isSupported:null!=n,enabled:!1,enable:function(){if(!this.enabled&&r){var t=r.createBufferSource();return t.buffer=r.createBuffer(1,1,22050),t.connect(r.destination),t.start?t.start(0,0,0):t.noteOn(0,0,0),this.enabled=!0,!0}return this.enabled}}})}();return n}),define("hilo/media/WebSound",["hilo/core/Hilo","hilo/media/HTMLAudio","hilo/media/WebAudio"],function(t,e,i){var n={_audios:{},enableAudio:function(){i.isSupported&&i.enable()},getAudio:function(t){t=this._normalizeSource(t);var n=this._audios[t.src];return n||(i.isSupported?n=new i(t):e.isSupported&&(n=new e(t)),this._audios[t.src]=n),n},removeAudio:function(t){var e="string"==typeof t?t:t.src,i=this._audios[e];i&&(i.stop(),i.off(),this._audios[e]=null,delete this._audios[e])},_normalizeSource:function(e){var i={};return"string"==typeof e?i={src:e}:t.copy(i,e),i}};return n}),define("hilo/game/Camera",["hilo/core/Hilo","hilo/core/Class"],function(t,e){var i=e.create({constructor:function(e){this.width=0,this.height=0,this.target=null,this.deadzone=null,this.bounds=null,this.scroll={x:0,y:0},t.copy(this,e)},tick:function(t){var e=this.target,i=this.scroll,n=this.bounds,r=this.deadzone;if(e){var a,o;r?(a=Math.min(Math.max(e.x-i.x,r[0]),r[0]+r[2]),o=Math.min(Math.max(e.y-i.y,r[1]),r[1]+r[3])):(a=.5*this.width,o=.5*this.height),i.x=e.x-a,i.y=e.y-o,n&&(i.x=Math.min(Math.max(i.x,n[0]),n[0]+n[2]),i.y=Math.min(Math.max(i.y,n[1]),n[0]+n[3]))}else i.x=0,i.y=0},follow:function(t,e){this.target=t,void 0!==e&&(this.deadzone=e),this.tick()}});return i}),define("hilo/game/Camera3d",["hilo/core/Hilo","hilo/core/Class"],function(t,e){var i=function(){function i(t,e,i,n,r){return{x:t,y:e*n-i*r,z:e*r+i*n}}function n(t,e,i,n,r){return{x:t*n-i*r,y:e,z:t*r+i*n}}function r(t,e,i,n,r){return{x:t*n-e*r,y:t*r+e*n,z:i}}var a=Math.PI/180,o=e.create({constructor:function(e){e.x=e.x||0,e.y=e.y||0,e.z=e.z||0,e.rotationX=e.rotationX||0,e.rotationY=e.rotationY||0,e.rotationZ=e.rotationZ||0,t.copy(this,e)},translate:function(t,e,i){this.tx=t,this.ty=e,this.tz=i},rotateX:function(t){this.rotationX=t},rotateY:function(t){this.rotationY=t},rotateZ:function(t){this.rotationZ=t},project:function(t,e){var o=this.rotationX*a,s=this.rotationY*a,h=this.rotationZ*a,l=Math.cos(o),c=Math.sin(o),u=Math.cos(s),d=Math.sin(s),f=Math.cos(h),v=Math.sin(h),p=t.x-this.x,m=t.y-this.y,g=t.z-this.z,_=r(p,m,g,f,v);_=n(_.x,_.y,_.z,u,d),_=i(_.x,_.y,_.z,l,c),this.tx&&(_.x-=this.tx),this.ty&&(_.y-=this.ty),this.tz&&(_.z-=this.tz);var y=this.fv/(this.fv+_.z),x=_.x*y,w=-_.y*y;return e?(e.x=x+this.fx,e.y=w+this.fy,e.z=-_.z,e.scaleX=y,e.scaleY=y,void 0):{x:x+this.fx,y:w+this.fy,z:-_.z,scale:y}},sortZ:function(){this.stage.children.sort(function(t,e){return t.z>e.z})},tick:function(){this.sortZ()}});return o}();return i}),define("hilo/game/ParticleSystem",["hilo/core/Hilo","hilo/core/Class","hilo/view/View","hilo/view/Container","hilo/view/Bitmap","hilo/view/Drawable"],function(t,e,i,n,r,a){var o=function(){function r(t,e){return e?t+2*(Math.random()-.5)*e:t}for(var o=["x","y","vx","vy","ax","ay","rotation","rotationV","scale","scaleV","alpha","alphaV","life"],s=[],h=0,l=o.length;l>h;h++){var c=o[h];s.push(c),s.push(c+"Var")}var u={x:0,y:0,vx:0,vy:0,ax:0,ay:0,scale:1,scaleV:0,alpha:1,alphaV:0,rotation:0,rotationV:0,life:1},d=[],f=e.create({Extends:n,constructor:function p(e){this.id=this.id||e.id||t.getUid("ParticleSystem"),this.emitterX=0,this.emitterY=0,this.gx=0,this.gy=0,this.totalTime=1/0,this.emitNum=10,this.emitNumVar=0,this.emitTime=.2,this.emitTimeVar=0,this.particle={},p.superclass.constructor.call(this,e),this.reset(e)},Statics:{PROPS:s,PROPS_DEFAULT:u,diedParticles:d},reset:function(e){t.copy(this,e),this.particle.system=this,this.totalTime<=0&&(this.totalTime=1/0)},onUpdate:function(t){t*=.001,this._isRun&&(this._totalRunTime+=t,this._currentRunTime+=t,this._currentRunTime>=this._emitTime&&(this._currentRunTime=0,this._emitTime=r(this.emitTime,this.emitTimeVar),this._emit()),this._totalRunTime>=this.totalTime&&this.stop())},_emit:function(){for(var t=r(this.emitNum,this.emitNumVar)>>0,e=0;t>e;e++)this.addChild(v.create(this.particle))},start:function(){this.stop(!0),this._currentRunTime=0,this._totalRunTime=0,this._isRun=!0,this._emitTime=r(this.emitTime,this.emitTimeVar)},stop:function(t){if(this.isRun=!1,t)for(var e=this.children.length-1;e>=0;e--)this.children[e].destroy()}}),v=e.create({Extends:i,constructor:function m(e){this.id=this.id||e.id||t.getUid("Particle"),m.superclass.constructor.call(this,e),this.init(e)},onUpdate:function(t){if(t*=.001,!this._died){var e=this.ax+this.system.gx,i=this.ay+this.system.gy;this.vx+=e*t,this.vy+=i*t,this.x+=this.vx*t,this.y+=this.vy*t,this.rotation+=this.rotationV,this._time>.1&&(this.alpha+=this.alphaV),this.scale+=this.scaleV,this.scaleX=this.scaleY=this.scale,this._time+=t,(this._time>=this.life||this.alpha<0)&&this.destroy()}},setImage:function(t,e){this.drawable=this.drawable||new a;var e=e||[0,0,t.width,t.height];this.width=e[2],this.height=e[3],this.drawable.rect=e,this.drawable.image=t},destroy:function(){this.died=!0,this.removeFromParent(),d.push(this)},init:function(t){this.system=t.system,this._died=!1,this._time=0,this.alpha=1;for(var e=0,i=s.length;i>e;e++){var n=s[e],a=void 0===t[n]?u[n]:t[n];this[n]=r(a,t[n+"Var"])}if(this.x+=this.system.emitterX,this.y+=this.system.emitterY,t.image){var o=t.frame;o&&o[0].length&&(o=o[Math.random()*o.length>>0]),this.setImage(t.image,o),void 0!==t.pivotX&&(this.pivotX=t.pivotX*o[2]),void 0!==t.pivotY&&(this.pivotY=t.pivotY*o[3])}},Statics:{create:function(t){if(d.length>0){var e=d.pop();return e.init(t),e}return new v(t)}}});return f}();return o});