/**
 * Hilo 1.1.10 for amd
 * Copyright 2016 alibaba.com
 * Licensed under the MIT License
 */
define("hilo/renderer/CanvasRenderer",["hilo/core/Class","hilo/core/Hilo","hilo/renderer/Renderer"],function(e,t,a){var i=e.create({Extends:a,constructor:function(e){i.superclass.constructor.call(this,e),this.context=this.canvas.getContext("2d")},renderType:"canvas",context:null,startDraw:function(e){return!!(e.visible&&e.alpha>0)&&(e===this.stage&&this.context.clearRect(0,0,e.width,e.height),e.blendMode!==this.blendMode&&(this.context.globalCompositeOperation=this.blendMode=e.blendMode),this.context.save(),!0)},draw:function(e){var t=this.context,a=e.width,i=e.height,r=e.background;r&&(t.fillStyle=r,t.fillRect(0,0,a,i));var n=e.drawable,s=n&&n.image;if(s){var l=n.rect,o=l[2],h=l[3],c=l[4],d=l[5];if(!o||!h)return;a||i||(a=e.width=o,i=e.height=h),(c||d)&&t.translate(c-.5*o,d-.5*h),t.drawImage(s,l[0],l[1],o,h,0,0,a,i)}},endDraw:function(e){this.context.restore()},transform:function(e){var a=e.drawable;if(a&&a.domElement)return void t.setElementStyleByView(e);var i=this.context,r=e.scaleX,n=e.scaleY;if(e===this.stage){var s=this.canvas.style,l=e._scaleX,o=e._scaleY,h=!1;(!l&&1!=r||l&&l!=r)&&(e._scaleX=r,s.width=r*e.width+"px",h=!0),(!o&&1!=n||o&&o!=n)&&(e._scaleY=n,s.height=n*e.height+"px",h=!0),h&&e.updateViewport()}else{var c=e.x,d=e.y,v=e.pivotX,g=e.pivotY,f=e.rotation%360,u=e.mask;u&&(u._render(this),i.clip());var p=e.align;if(p){var w=e.getAlignPosition();c=w.x,d=w.y}0==c&&0==d||i.translate(c,d),0!=f&&i.rotate(f*Math.PI/180),1==r&&1==n||i.scale(r,n),0==v&&0==g||i.translate(-v,-g)}e.alpha>0&&(i.globalAlpha*=e.alpha)},remove:function(e){var t=e.drawable,a=t&&t.domElement;if(a){var i=a.parentNode;i&&i.removeChild(a)}},clear:function(e,t,a,i){this.context.clearRect(e,t,a,i)},resize:function(e,t){var a=this.canvas,i=this.stage,r=a.style;a.width=e,a.height=t,r.width=i.width*i.scaleX+"px",r.height=i.height*i.scaleY+"px"}});return i});