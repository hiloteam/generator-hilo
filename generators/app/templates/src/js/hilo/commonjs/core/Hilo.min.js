/**
 * Hilo 1.1.7 for commonjs
 * Copyright 2016 alibaba.com
 * Licensed under the MIT License
 */
var browser=require("../util/browser"),util=require("../util/util"),win=window,doc=document,docElem=doc.documentElement,uid=0,hasWarnedDict={},Hilo={version:"1.1.7",getUid:function(e){var t=++uid;if(e){var o=e.charCodeAt(e.length-1);return o>=48&&o<=57&&(e+="_"),e+t}return t},viewToString:function(e){for(var t,o=e;o;)t=t?o.id+"."+t:o.id,o=o.parent;return t},copy:function(e,t,o){return util.copy(e,t,o),hasWarnedDict.copy||(hasWarnedDict.copy=!0,console.warn("Hilo.copy has been Deprecated! Use Hilo.util.copy instead.")),e},browser:browser,event:function(){var e="ontouchstart"in win;return{POINTER_START:e?"touchstart":"mousedown",POINTER_MOVE:e?"touchmove":"mousemove",POINTER_END:e?"touchend":"mouseup"}}(),align:{TOP_LEFT:"TL",TOP:"T",TOP_RIGHT:"TR",LEFT:"L",CENTER:"C",RIGHT:"R",BOTTOM_LEFT:"BL",BOTTOM:"B",BOTTOM_RIGHT:"BR"},getElementRect:function(e){var t;try{t=e.getBoundingClientRect()}catch(o){t={top:e.offsetTop,left:e.offsetLeft,right:e.offsetLeft+e.offsetWidth,bottom:e.offsetTop+e.offsetHeight}}var a=(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)||0,r=(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0)||0,i=win.getComputedStyle?getComputedStyle(e):e.currentStyle,n=parseInt,s=n(i.paddingLeft)+n(i.borderLeftWidth)||0,c=n(i.paddingTop)+n(i.borderTopWidth)||0,d=n(i.paddingRight)+n(i.borderRightWidth)||0,h=n(i.paddingBottom)+n(i.borderBottomWidth)||0,l=t.top||0,f=t.left||0,g=t.right||0,u=t.bottom||0;return{left:f+a+s,top:l+r+c,width:g-d-f-s,height:u-h-l-c}},createElement:function(e,t){var o,a,r,i=doc.createElement(e);for(o in t)if(a=t[o],"style"===o)for(r in a)i.style[r]=a[r];else i[o]=a;return i},getElement:function(e){return doc.getElementById(e)},setElementStyleByView:function(e){var t=e.drawable,o=t.domElement.style,a=e._stateCache||(e._stateCache={}),r=Hilo.browser.jsVendor,i="px",n=!1;if(this.cacheStateIfChanged(e,["visible"],a)&&(o.display=e.visible?"":"none"),this.cacheStateIfChanged(e,["alpha"],a)&&(o.opacity=e.alpha),e.visible&&!(e.alpha<=0)){this.cacheStateIfChanged(e,["width"],a)&&(o.width=e.width+i),this.cacheStateIfChanged(e,["height"],a)&&(o.height=e.height+i),this.cacheStateIfChanged(e,["depth"],a)&&(o.zIndex=e.depth+1),(n=this.cacheStateIfChanged(e,["pivotX","pivotY"],a))&&(o[r+"TransformOrigin"]=e.pivotX+i+" "+e.pivotY+i),(this.cacheStateIfChanged(e,["x","y","rotation","scaleX","scaleY"],a)||n)&&(o[r+"Transform"]=this.getTransformCSS(e)),this.cacheStateIfChanged(e,["background"],a)&&(o.backgroundColor=e.background),o.pointerEvents||(o.pointerEvents="none");var s=t.image;if(s){var c=s.src;c!==a.image&&(a.image=c,o.backgroundImage="url("+c+")");var d=t.rect;if(d){var h=d[0],l=d[1];h!==a.sx&&(a.sx=h,o.backgroundPositionX=-h+i),l!==a.sy&&(a.sy=l,o.backgroundPositionY=-l+i)}}var f=e.mask;if(f){var g=f.drawable.domElement.style.backgroundImage;g!==a.maskImage&&(a.maskImage=g,o[r+"MaskImage"]=g,o[r+"MaskRepeat"]="no-repeat");var u=f.x,p=f.y;u===a.maskX&&p===a.maskY||(a.maskX=u,a.maskY=p,o[r+"MaskPosition"]=u+i+" "+p+i)}}},cacheStateIfChanged:function(e,t,o){var a,r,i,n,s=!1;for(a=0,r=t.length;a<r;a++)i=t[a],n=e[i],n!=o[i]&&(o[i]=n,s=!0);return s},getTransformCSS:function(e){var t=this.browser.supportTransform3D,o=t?"3d":"";return"translate"+o+"("+(e.x-e.pivotX)+"px, "+(e.y-e.pivotY)+(t?"px, 0px)":"px)")+"rotate"+o+(t?"(0, 0, 1, ":"(")+e.rotation+"deg)scale"+o+"("+e.scaleX+", "+e.scaleY+(t?", 1)":")")}};module.exports=Hilo;